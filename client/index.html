<!DOCTYPE html>
<html>
<body>
<h1>WebSocket Chat</h1>
<ul id="messages"></ul>
<input id="username" placeholder="Username" />
<input id="message" placeholder="Message" />
<button onclick="sendMessage()">Send</button>

<script>
    const token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywidXNlcm5hbWUiOiJOaW5pMTEiLCJpYXQiOjE3MzY5NzcxNDEsImV4cCI6MTczNjk4MDc0MX0.ZSRjuvZwxGLq8aF1zC4hJtnEgXUBUKkZgAtgJ8-n2cQ'; // Replace with actual JWT token
    const socket = new WebSocket(`ws://localhost:3001?token=${token}`);
    const messages = document.getElementById('messages');

    socket.onmessage = (event) => {
        const { type, data } = JSON.parse(event.data);
        if (type === 'new_message') {
            const li = document.createElement('li');
            li.textContent = `${data.senderId}: ${data.message} (${new Date(data.createdAt).toLocaleTimeString()})`;
            messages.appendChild(li);
        }
    };

    function sendMessage() {
        const username = document.getElementById('username').value;
        const message = document.getElementById('message').value;
        if (username && message) {
            const recipientId = 2; // Specify recipient ID here
            socket.send(JSON.stringify({ username, recipientId, message }));
        }
    }
</script>
</body>
</html>
